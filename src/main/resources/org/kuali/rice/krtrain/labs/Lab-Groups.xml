<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

    <bean id="publisherGroup" parent="Uif-SectionBase" p:headerText="Publisher Information"
          p:instructionalText="If no publisher information is available this section may be left blank.">
        <property name="layoutManager">
            <bean parent="Uif-VerticalBoxLayout"/>
        </property>
        <property name="header.rightGroup">
            <bean parent="Uif-HeaderRightGroup">
                <property name="items">
                    <list>
                        <bean parent="Uif-Link" p:linkText="List of Publishers" p:target="_blank"
                              p:href="http://en.wikipedia.org/wiki/List_of_English-language_book_publishing_companies"
                              p:openInLightbox="true"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="items">
            <list>
                <bean id="publisher" parent="Uif-InputField" p:propertyName="publisher"
                      p:label="Publisher"/>

                <bean parent="Uif-InputField" p:propertyName="publisherCode"
                      p:minLength="1" p:constraintText="#xxx format"
                      p:dictionaryObjectEntry="org.kuali.rice.krtrain.book.PublisherCode"
                      p:dictionaryAttributeName="code" p:propertyNamesForAdditionalDisplay="pubCode.name">
                    <property name="attributeQuery">
                        <bean parent="Uif-AttributeQueryConfig"
                              p:queryMethodArgumentFieldList="publisherCode" p:returnFieldMapping="name:pubCode.name"
                              p:queryMethodInvokerConfig.staticMethod="org.kuali.rice.krtrain.util.QueryUtils.retrievePublisherCode"/>
                    </property>

                    <property name="suggest">
                        <bean parent="Uif-Suggest" p:valuePropertyName="code"
                              p:suggestQuery.dataObjectClassName="org.kuali.rice.krtrain.book.PublisherCode" />
                    </property>
                </bean>

                <ref bean="publisherDetails"/>
            </list>
        </property>
        <property name="footer">
            <bean parent="Uif-FooterBase">
                <property name="items">
                    <list>
		                <bean parent="Uif-PrimaryActionButton-Small" p:methodToCall="viewPublisher"
		                      p:actionLabel="publisher summary" p:actionParameters="format:summary"
		                      p:refreshId="publisherGroup"
		                      p:successCallback="alert('publisher information retrieved');"/>
		
		                <bean parent="Uif-PrimaryActionButton-Small" p:methodToCall="viewPublisher"
		                      p:actionLabel="publisher details" p:actionParameters="format:detail"
		                      p:refreshId="publisherGroup"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="publisherDetails" parent="Uif-Disclosure-SubSectionBase" p:headerText="Publisher Details"
          p:disclosure.defaultOpen="false">
        <property name="layoutManager">
            <bean parent="Uif-VerticalBoxLayout"/>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-InputField" p:propertyName="publisherAddress" p:label="Publisher Address">
                    <property name="control">
                        <bean parent="Uif-MediumTextControl" p:watermarkText="street # name"/>
                    </property>
                </bean>

                <bean parent="Uif-InputField" p:propertyName="publisherState" p:label="Publisher State">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="2"/>
                    </property>
                </bean>

                <bean parent="Uif-InputField" p:propertyName="publicationDate" p:label="Publisher Date">
                    <property name="control">
                        <bean parent="Uif-DateControl"/>
                    </property>
                </bean>

                <bean parent="Uif-ImageField" p:source="@{#ConfigProperties['application.url']}/images/publisher.png"
                      p:altText="publisher logo" p:captionHeaderText="Publisher Logo"
                      p:cutlineText="logo created by [i]entangled publishing[/i], [id=copyrightImage]2013">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>border-photo</value>
                        </list>
                    </property>
                </bean>

                <bean parent="Uif-Message"
                      p:messageText="There are @{book.numberPublisherBooks} books from this publisher.">
                    <property name="cssClasses">
                        <list merge="true">
                            <value>message-highlight</value>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="authorGroup" parent="Uif-SectionBase" p:headerText="Author Information">
        <property name="layoutManager">
            <bean parent="Uif-VerticalBoxLayout"/>
        </property>

        <property name="header.lowerGroup">
            <bean parent="Uif-HeaderLowerGroup">
                <property name="items">
                    <list>
                        <bean parent="Uif-InputField" p:propertyName="author.numberWrittenBooks" p:label="Written Books"
                              p:readOnly="true"
                              p:readOnlyDisplayReplacement="@{book.author.numberWrittenBooks} (@{book.author.numberPublishedBooks} published)"/>
                    </list>
                </property>
            </bean>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-InputField" p:bindingInfo.bindByNamePrefix="author"
                      p:propertyName="authorName" p:label="Author Name" p:additionalHiddenPropertyNames="authorId">
                    <property name="quickfinder">
                        <bean parent="Uif-QuickFinder" p:dataObjectClassName="org.kuali.rice.krtrain.book.Author"
                              p:fieldConversions="authorId:authorId,authorName:authorName,email:email"
                              p:lookupParameters="email:email" p:readOnlyLookupFields="email"/>
                    </property>
                </bean>

                <bean parent="Uif-InputField" p:bindingInfo.bindByNamePrefix="author"
                      p:propertyName="email" p:label="Author Email"/>

                <bean parent="Uif-LinkGroup" p:linkSeparator="|">
                    <property name="items">
                         <list>
                             <bean parent="Uif-Link" p:linkText="Facebook" p:target="_blank"
                                   p:href="http://www.facebook.com"/>
                             <bean parent="Uif-Link" p:linkText="Twitter" p:target="_blank"
                                   p:href="http://www.twitter.com"/>
                             <bean parent="Uif-Link" p:linkText="Linkedin" p:target="_blank"
                                   p:href="http://www.linkedin.com"/>
                         </list>
                    </property>
                </bean>
            </list>
        </property>
        <property name="footer">
            <bean parent="Uif-FooterBase">
                <property name="items">
                    <list>
		                <bean parent="Uif-SecondaryActionButton" p:methodToCall="viewAuthorBooks"
		                      p:actionLabel="view author books" p:iconClass="icon-books"/>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

</beans>